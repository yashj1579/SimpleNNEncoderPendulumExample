# Double Pendulum Dynamics Prediction Using Neural Networks

## Project Overview

This project demonstrates how a neural network can learn the dynamics of a **double pendulum** and predict future states based on past trajectories. The project combines classical mechanics, neural networks, and data-driven modeling to create a visually engaging and educational simulation of a chaotic system.

Unlike the single pendulum, the double pendulum exhibits **chaotic motion**, meaning small differences in initial conditions lead to drastically different trajectories. This project highlights how a neural network can still capture short-term predictions and reproduce realistic motion patterns.

## Video Demonstration

Check out the trained neural network predicting double pendulum motion:

[*Watch the video*](https://youtu.be/FkcBPxozQm4)

**Description:**
This video shows the actual double pendulum (green) swinging alongside the predicted trajectory (purple) generated by the trained neural network.
The orange trailing points indicate the previous states used for prediction. This visualization demonstrates how well the model learned to forecast the chaotic motion of the double pendulum.

---

## What This Project Teaches

* Generating data from exact ODE integration for a double pendulum.
* Normalizing and preprocessing trajectories for neural network training.
* Implementing a feedforward encoder-decoder neural network in PyTorch to predict future states.
* Training a neural network using mean squared error (MSE) loss and visualizing training/testing performance.
* Handling **multi-dimensional state spaces** (x, y positions of both pendulum masses) and chaotic systems.
* Creating animated visualizations of both real and predicted double pendulum trajectories.

---

## What I Did

* Implemented `ExactODE.py` to numerically integrate **double pendulum dynamics**.
* Built `NNTrainingCode.py` to preprocess data, create an encoder-decoder neural network, train it, and save the model and normalization parameters.
* Created `NNDoublePendulumVisualization.py` to load the trained model, generate predictions, and animate the double pendulum with predicted trajectories.
* Added visualization enhancements including trailing points, fading markers, and color-coded predictions.
* Adjusted data representation and neural network input/output to accommodate **both pendulum masses and their positions**, unlike the single pendulum.

---

## Potential Future Improvements

* Extend to varying double pendulum parameters (different lengths/masses).
* Incorporate **physics-informed losses** to enforce conservation of energy.
* Use **Neural ODEs** for continuous-time predictions.
* Improve animation with smoother transitions or interactive controls.
* Explore **RNNs or transformers** to predict longer chaotic trajectories more accurately.

---

## How to Run the Project

### 1. Install Dependencies

Make sure you have Python 3.9+ and the following packages installed:
```bash
pip install numpy matplotlib torch
```

---

### 2. Generate Double Pendulum Data

The data is generated automatically in `NNTrainingCode.py` using the `ExactODE.exact_integration` function.

You can modify:

* `t` → the time vector
* `x_init` → initial angles & velocities for both pendulums
* `lens` → number of previous points used for prediction

---

### 3. Train the Neural Network

Run the training script:
```bash
python NNTrainingCode.py
```
The script will:

* Normalize the data
* Split it into training and testing sets
* Train an encoder-decoder neural network on the **multi-dimensional state**
* Save the trained model (`double_pendulum_model.pth`) and normalization parameters (`normalization.npz`)
* Plot training and testing loss curves

---

### 4. Run the Neural Network Simulation & Animation

Run the animation script:

python NNDoublePendulumVisualization.py

The script will:

* Load the trained model and normalization parameters
* Generate predictions for each frame based on previous trajectory points
* Animate the double pendulum showing:

  * Previous trajectory (orange)
  * True double pendulum trajectory (green)
  * Predicted trajectory (purple)
* Save the animation as `double_pendulum.mp4`

---

## File Overview

| File                             | Description                                                               |
| -------------------------------- | ------------------------------------------------------------------------- |
| ExactODE.py                      | Exact numerical integration of the **double pendulum ODE**                |
| NNTrainingCode.py                | Data preprocessing, neural network definition, training, and saving model |
| NNDoublePendulumVisualization.py | Load model, generate predictions, animate double pendulum                 |
| README.md                        | Project overview and instructions                                         |
